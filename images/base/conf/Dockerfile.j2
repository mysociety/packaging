FROM {{ distro }}:{{ codename }}
ENV DEBIAN_FRONTEND=noninteractive
COPY sources.list.{{ codename }} /etc/apt/sources.list.d/debian.list

RUN rm -f /etc/apt/sources.list /etc/apt/sources.list.d/debian.sources; apt-get update -qq \
      && apt-get install -qq \
          apt-transport-https \
          build-essential \
          curl \
          devscripts \
          fakeroot \
          git \
          gnupg \
          libffi-dev \
          libperl-dev \
          lsb-release \
          ruby-dev \
          wget \
        --no-install-recommends > /dev/null \
      && apt-get install -qq debhelper \
      && rm -r /var/lib/apt/lists/*

RUN gem install --no-document fpm
RUN adduser --shell /bin/bash --disabled-password --gecos "" builder
COPY ./files/MyConfig.pm /home/builder/.cpan/CPAN/
RUN chown -R builder:builder /home/builder/
